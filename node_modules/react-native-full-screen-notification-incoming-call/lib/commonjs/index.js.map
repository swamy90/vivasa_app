{"version":3,"names":["isAndroid","Platform","OS","RNNotificationIncomingCall","NativeModules","FullScreenNotificationIncomingCall","eventEmitter","NativeEventEmitter","RNNotificationEvent","CallAction","RNNotificationCall","constructor","uuid","avatar","timeout","foregroundOptions","displayNotification","hideNotification","backToApp","type","handler","listener","addListener","RNNotificationAnswerAction","eventPayload","RNNotificationEndCallAction","_notificationEventHandlers","set","get","remove","delete","payload","data","callUUID","endAction","ACTION_REJECTED_CALL","DeviceEventEmitter","emit","Map"],"sources":["index.tsx"],"sourcesContent":["import { DeviceEventEmitter, NativeEventEmitter, NativeModules, Platform } from 'react-native';\nconst isAndroid = Platform.OS === 'android';\nconst RNNotificationIncomingCall = NativeModules.FullScreenNotificationIncomingCall;\nlet eventEmitter: any\nif (isAndroid) {\n  eventEmitter = new NativeEventEmitter(RNNotificationIncomingCall);\n}\nenum RNNotificationEvent {\n  RNNotificationAnswerAction = 'RNNotificationAnswerAction',\n  RNNotificationEndCallAction = 'RNNotificationEndCallAction'\n}\nenum CallAction {\n  ACTION_END_CALL = \"ACTION_END_CALL\",\n  ACTION_REJECTED_CALL = \"ACTION_REJECTED_CALL\",\n  ACTION_HIDE_CALL = \"ACTION_HIDE_CALL\",\n  ACTION_SHOW_INCOMING_CALL = \"ACTION_SHOW_INCOMING_CALL\",\n  HIDE_NOTIFICATION_INCOMING_CALL = \"HIDE_NOTIFICATION_INCOMING_CALL\",\n  ACTION_PRESS_ANSWER_CALL = \"ACTION_PRESS_ANSWER_CALL\",\n  ACTION_PRESS_DECLINE_CALL = \"ACTION_PRESS_DECLINE_CALL\",\n  ACTION_START_ACTIVITY = \"ACTION_START_ACTIVITY\",\n}\n\nexport interface foregroundOptionsModel {\n  channelId: string;\n  channelName: string;\n  notificationIcon: string;//mipmap\n  notificationTitle: string;\n  notificationBody: string;\n  answerText: string;\n  declineText: string;\n  notificationColor?: string;\n  notificationSound?: string;//raw\n  mainComponent?: string;\n  payload?:any//more info\n}\nexport interface customIncomingActivityProps {\n  avatar?: string;\n  info?: string;\n  uuid: string;\n  payload?: any\n}\nexport interface answerPayload{\n  callUUID:string;\n  payload?:string; // jsonString\n}\nexport interface declinePayload{\n  callUUID:string;\n  payload?:string; // jsonString\n  endAction:\"ACTION_REJECTED_CALL\"|\"ACTION_HIDE_CALL\"; //ACTION_REJECTED_CALL => press button decline or call function declineCall\n}\nclass RNNotificationCall {\n  private _notificationEventHandlers;\n  constructor() {\n    this._notificationEventHandlers = new Map();\n  }\n\n  displayNotification = (uuid: string, avatar: string | null, timeout: number | null, foregroundOptions: foregroundOptionsModel) => {\n    if (!isAndroid) return\n    RNNotificationIncomingCall.displayNotification(uuid, avatar, timeout ? timeout : 0, foregroundOptions)\n  }\n\n  hideNotification = () => {\n    if (!isAndroid) return\n    RNNotificationIncomingCall.hideNotification()\n  }\n\n  //function only work when open app from quit state\n  backToApp = () => {\n    if (!isAndroid) return\n    RNNotificationIncomingCall.backToApp()\n  }\n\n  addEventListener = (type: string, handler: any) => {\n    if (!isAndroid) return\n    let listener;\n    if (type === 'answer') {\n      listener = eventEmitter.addListener(\n        RNNotificationEvent.RNNotificationAnswerAction,\n        (eventPayload: answerPayload) => {\n          handler(eventPayload);\n        }\n      );\n    } else if (type === 'endCall') {\n      listener = eventEmitter.addListener(\n        RNNotificationEvent.RNNotificationEndCallAction,\n        (eventPayload: declinePayload) => {\n          handler(eventPayload);\n        }\n      );\n    }\n    else {\n      return;\n    }\n    this._notificationEventHandlers.set(type, listener);\n  };\n\n  removeEventListener = (type: any) => {\n    if (!isAndroid) return\n    const listener = this._notificationEventHandlers.get(type);\n    if (!listener) {\n      return;\n    }\n\n    listener.remove();\n    this._notificationEventHandlers.delete(type);\n  };\n  declineCall = (uuid: string ,payload?:string) => {\n    this.hideNotification()\n    const data = {\n      callUUID: uuid,\n      endAction: CallAction.ACTION_REJECTED_CALL,\n      payload\n    }\n    DeviceEventEmitter.emit(RNNotificationEvent.RNNotificationEndCallAction, data)\n  }\n  answerCall = (uuid: string ,payload?:string) => {\n    this.hideNotification()\n    const data = { callUUID: uuid,payload }\n    DeviceEventEmitter.emit(RNNotificationEvent.RNNotificationAnswerAction, data)\n  }\n}\n\nexport default new RNNotificationCall();"],"mappings":"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"}